# Author: James Ashmore
# Copyright: Copyright 2020, James Ashmore
# Email: jashmore@ed.ac.uk
# License: MIT

# Project file
pepfile: "config/config.yaml"

# Include rules
include: "rules/alevinqc.smk"
include: "rules/busparse.smk"
include: "rules/bustools.smk"
include: "rules/cutadapt.smk"
include: "rules/eisar.smk"
include: "rules/genomepy.smk"
include: "rules/gffread.smk"
include: "rules/kallisto.smk"
include: "rules/multiqc.smk"
include: "rules/salmon.smk"
include: "rules/singlecellexperiment.smk"
include: "rules/star.smk"

rule all:
    input:
        # genomepy
        "results/genomepy/GRCm38.p6/GRCm38.p6.annotation.bed",
        "results/genomepy/GRCm38.p6/GRCm38.p6.annotation.gtf",
        "results/genomepy/GRCm38.p6/GRCm38.p6.fa",
        "results/genomepy/GRCm38.p6/GRCm38.p6.fa.fai",
        "results/genomepy/GRCm38.p6/GRCm38.p6.fa.sizes",
        "results/genomepy/GRCm38.p6/GRCm38.p6.gaps.bed",
        "results/genomepy/GRCm38.p6/README.txt",
        # gffread
        "results/gffread/GRCm38.p6/GRCm38.p6.tx2gene.tsv",
        "results/gffread/GRCm38.p6/GRCm38.p6.id2name.tsv",
        "results/gffread/GRCm38.p6/GRCm38.p6.mrna.txt",
        "results/gffread/GRCm38.p6/GRCm38.p6.rrna.txt",
        # busparse
        "results/busparse/GRCm38.p6/cDNA_introns.fa",
        "results/busparse/GRCm38.p6/cDNA_tx_to_capture.txt",
        "results/busparse/GRCm38.p6/introns_tx_to_capture.txt",
        "results/busparse/GRCm38.p6/tr2g.tsv",
        # kallisto
        "results/kallisto/GRCm38.p6.idx",
        "results/kallisto/SI-GA-E1/matrix.ec",
        "results/kallisto/SI-GA-E1/output.bus",
        "results/kallisto/SI-GA-E1/run_info.json",
        "results/kallisto/SI-GA-E1/transcripts.txt",
        # bustools
        "results/bustools/SI-GA-E1/output.correct.bus",
        "results/bustools/SI-GA-E1/output.correct.sort.bus",
        "results/bustools/SI-GA-E1/output.correct.sort.spliced.bus",
        "results/bustools/SI-GA-E1/output.correct.sort.unspliced.bus",
        "results/bustools/SI-GA-E1/output.correct.sort.spliced.barcodes.txt",
        "results/bustools/SI-GA-E1/output.correct.sort.spliced.genes.txt",
        "results/bustools/SI-GA-E1/output.correct.sort.spliced.mtx",
        "results/bustools/SI-GA-E1/output.correct.sort.unspliced.barcodes.txt",
        "results/bustools/SI-GA-E1/output.correct.sort.unspliced.genes.txt",
        "results/bustools/SI-GA-E1/output.correct.sort.unspliced.mtx",
        # eisar
        "results/eisar/GRCm38.p6/GRCm38.p6.annotation.gtf",
        "results/eisar/GRCm38.p6/GRCm38.p6.fa",
        "results/eisar/GRCm38.p6/GRCm38.p6.features.tsv",
        "results/eisar/GRCm38.p6/GRCm38.p6.tx2gene.tsv",
        # salmon
        "results/salmon/index/GRCm38.p6",
        "results/salmon/alevin/SI-GA-E1/alevin/quants_mat.gz",
        "results/alevinqc/SI-GA-E1.html",
        # star
        "results/star/index/GRCm38.p6",
        "results/star/solo/SI-GA-E1/Aligned.sortedByCoord.out.bam",
        "results/singlecellexperiment/SI-GA-E1/star.rds"